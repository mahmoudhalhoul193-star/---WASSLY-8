<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wassaly</title>
<style>
:root{--primary:#607d8b;--bg:#e0e0e0;--card:#fff;--text:#222;}
body.dark{--primary:#00bcd4;--bg:#121226;--card:#1e1e2f;--text:#eee;}
*{box-sizing:border-box;}
body{margin:0;font-family:Segoe UI,Arial;background:var(--bg);color:var(--text);transition:.3s;}
header,footer{background:var(--card);margin:10px;padding:15px;border-radius:16px;text-align:center;}
nav{display:flex;justify-content:center;gap:10px;}
nav button{padding:10px 18px;border:none;border-radius:12px;background:var(--primary);color:#fff;cursor:pointer;}
.page{display:none}
.page.active{display:block}
.box{max-width:700px;margin:20px auto;background:var(--card);padding:20px;border-radius:20px;}
input,select,textarea,button{width:100%;margin:6px 0;padding:12px;border-radius:12px;border:1px solid #ccc;}
.order{border:1px dashed #aaa;border-radius:12px;padding:10px;margin:8px 0;}
.top-controls{position:fixed;top:15px;left:15px;display:flex;gap:10px;z-index:9999;}
.ctrl-btn{width:46px;height:46px;border-radius:50%;background:var(--primary);color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:18px;}
#help{position:fixed;right:20px;bottom:20px;}
#help button{background:#25D366;color:#fff;border:none;padding:10px 14px;border-radius:12px;}
#helpOptions{display:none;background:var(--card);border-radius:12px;margin-bottom:8px;}
#helpOptions a{display:block;padding:10px;text-decoration:none;color:var(--text);}
#orderMsg,#driverMsg{color:green;text-align:center;margin-top:10px;display:none;}
</style>
</head>
<body>

<div class="top-controls">
  <div class="ctrl-btn" id="themeBtn" onclick="toggleTheme()">ğŸŒ</div>
  <div class="ctrl-btn" id="langBtn" onclick="toggleLang()">AR</div>
</div>

<header>
<h1 data-i18n="title">ÙˆØµÙ„ÙŠ</h1>
<p data-i18n="desc">Ø®Ø¯Ù…Ø© ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹Ø© ÙˆØ¢Ù…Ù†Ø©</p>
</header>

<nav>
<button onclick="showPage('order')" data-i18n="order">Ø·Ù„Ø¨</button>
<button onclick="showPage('driver')" data-i18n="driver">Ø³ÙˆØ§Ù‚</button>
<button onclick="showPage('admin')" data-i18n="admin">Ø£Ø¯Ù…Ù†</button>
</nav>

<!-- ORDER -->
<section id="order" class="page active">
<div class="box">
<input id="cname" data-i18n-placeholder="cname" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„">
<input id="cphone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
<input id="clocation" data-i18n-placeholder="location" placeholder="Ø§Ù„Ù…ÙˆÙ‚Ø¹">
<textarea id="details" data-i18n-placeholder="details" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨"></textarea>
<input type="number" id="price" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<select id="selectDriver"><option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ§Ù‚</option></select>
<button onclick="sendOrder()" data-i18n="send">Ø¥Ø±Ø³Ø§Ù„</button>
<div id="orderMsg">âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­</div>
</div>
</section>

<!-- DRIVER -->
<section id="driver" class="page">
<div class="box">
<input id="dname" data-i18n-placeholder="dname" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ§Ù‚">
<input id="dphone" placeholder="ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„Ø³ÙˆØ§Ù‚">
<select id="vehicle">
  <option value="Bike">Ø¹Ø¬Ù„Ø©</option>
  <option value="Motorcycle">Ù…ÙˆØªÙˆØ³ÙŠÙƒÙ„</option>
  <option value="Car">Ø¹Ø±Ø¨ÙŠØ©</option>
  <option value="Toktok">ØªÙˆÙƒ ØªÙˆÙƒ</option>
</select>
<button onclick="loginDriver()" data-i18n="login">Ø¯Ø®ÙˆÙ„</button>
<div id="driverMsg">âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„Ùƒ Ø¨Ù†Ø¬Ø§Ø­</div>
</div>
</section>

<!-- ADMIN -->
<section id="admin" class="page">
<div class="box">
<input type="password" id="adminPass" placeholder="Password">
<button onclick="adminLogin()">Login</button>
<div id="adminPanel" style="display:none">
<p id="stats"></p>
<h3>Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h3>
<div id="allOrders"></div>
<h3>Ø§Ù„Ø³ÙˆØ§Ù‚ÙŠÙ†</h3>
<div id="allDrivers"></div>
</div>
</div>
</section>

<!-- HELP -->
<div id="help">
<div id="helpOptions">
<a href="https://wa.me/201208624618?text=ØªØ£Ø®ÙŠØ± Ø§Ù„Ø·Ù„Ø¨">â° ØªØ£Ø®ÙŠØ±</a>
<a href="https://wa.me/201208624618?text=Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø³ÙˆØ§Ù‚">ğŸ“ Ø§Ù„Ø³ÙˆØ§Ù‚</a>
<a href="https://wa.me/201208624618?text=Ù…Ø´ÙƒÙ„Ø© Ø³Ø¹Ø±">ğŸ’° Ø§Ù„Ø³Ø¹Ø±</a>
</div>
<button onclick="toggleHelp()">ğŸ’¬ Ø¯Ø¹Ù…</button>
</div>

<footer>Â© Wassaly</footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

<script>
// ==== Firebase Config (Ø­Ø· Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù‡Ù†Ø§) ====
const firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT_ID.firebaseapp.com",
  databaseURL: "https://PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "PROJECT_ID",
  storageBucket: "PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ===== UI + Language =====
let lang="AR";
const T = {
  AR:{title:"ÙˆØµÙ„ÙŠ",desc:"Ø®Ø¯Ù…Ø© ØªÙˆØµÙŠÙ„ Ø³Ø±ÙŠØ¹Ø© ÙˆØ¢Ù…Ù†Ø©",order:"Ø·Ù„Ø¨",driver:"Ø³ÙˆØ§Ù‚",admin:"Ø£Ø¯Ù…Ù†",
  send:"Ø¥Ø±Ø³Ø§Ù„",login:"Ø¯Ø®ÙˆÙ„",cname:"Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„",location:"Ø§Ù„Ù…ÙˆÙ‚Ø¹",details:"ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨",dname:"Ø§Ø³Ù… Ø§Ù„Ø³ÙˆØ§Ù‚",vehicle:"Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©"},
  EN:{title:"Wassaly",desc:"Fast & Safe Delivery",order:"Order",driver:"Driver",admin:"Admin",
  send:"Send",login:"Login",cname:"Customer Name",location:"Location",details:"Order details",dname:"Driver Name",vehicle:"Vehicle"}
};

function showPage(id){document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));document.getElementById(id).classList.add("active");}
function toggleTheme(){document.body.classList.toggle("dark");themeBtn.innerText=document.body.classList.contains("dark")?"ğŸŒ™":"ğŸŒ";}
function toggleLang(){
  lang = lang==="AR"?"EN":"AR";
  document.documentElement.dir = lang==="AR"?"rtl":"ltr";
  langBtn.innerText = lang;
  document.querySelectorAll("[data-i18n]").forEach(e=>{e.innerText=T[lang][e.dataset.i18n];});
  document.querySelectorAll("[data-i18n-placeholder]").forEach(e=>{e.placeholder=T[lang][e.dataset.i18nPlaceholder];});
}
function toggleHelp(){helpOptions.style.display=helpOptions.style.display==="block"?"none":"block";}

// ===== Firebase Listeners =====

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø³ÙˆØ§Ù‚ÙŠÙ† ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
db.ref("drivers").on("value", snap => {
  const data = snap.val() || {};
  drivers = Object.values(data);
  renderDriversSelect();
  renderAdmin();
});

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
db.ref("orders").on("value", snap => {
  const data = snap.val() || {};
  orders = Object.values(data);
  renderAdmin();
});

// ===== Driver Login & Save =====
function loginDriver(){
  const name=dname.value.trim(); const phone=dphone.value.trim(); const vehicleType=vehicle.value;
  if(!name||!phone){alert("Ø¨ÙŠØ§Ù†Ø§Øª ØºÙŠØ± ØµØ­ÙŠØ­Ø©");return;}
  const newDriver = {name,phone,vehicle:vehicleType};
  db.ref("drivers/"+phone).set(newDriver);
  driverMsg.style.display="block"; setTimeout(()=>driverMsg.style.display="none",2000);
}

// ===== Send Order & Save =====
function sendOrder(){
  const orderKey = db.ref().child("orders").push().key;
  const orderData = {
    id: orderKey,
    cname:cname.value,
    phone:cphone.value,
    location:clocation.value,
    details:details.value,
    price:price.value,
    driver:selectDriver.value
  };
  db.ref("orders/"+orderKey).set(orderData);
  orderMsg.style.display="block"; setTimeout(()=>orderMsg.style.display="none",2000);
  sendWhats(orderData);
}

// ===== WhatsApp =====
function sendWhats(o){
  const d = drivers.find(x=>x.phone===o.driver);
  if(!d) return;
  const msg=`Ù…Ø±Ø­Ø¨Ø§ ${d.name}!\nÙ„Ø¯ÙŠÙƒ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ ğŸš€\nğŸ‘¤ Ø§Ù„Ø¹Ù…ÙŠÙ„: ${o.cname}\nğŸ“ ${o.phone}\nğŸ“ ${o.details}\nğŸš— ${d.vehicle}\nğŸ’° ${o.price}`;
  window.open(`https://wa.me/${d.phone}?text=${encodeURIComponent(msg)}`);
}

// ===== Admin =====
function adminLogin(){if(adminPass.value==="01208624618679001"){adminPanel.style.display="block"; renderAdmin();}}

function renderAdmin(){
  stats.innerText=`Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${orders.length} | Ø§Ù„Ø³ÙˆØ§Ù‚ÙŠÙ†: ${drivers.length}`;
  allOrders.innerHTML=""; orders.forEach((o,i)=>{allOrders.innerHTML+=`<div class="order">ğŸ“¦ ${o.details} - ${o.price}Ø¬ <button onclick="deleteOrder('${o.id}')">ğŸ—‘</button></div>`;});
  allDrivers.innerHTML=""; drivers.forEach((d,i)=>{allDrivers.innerHTML+=`<div class="order">ğŸš— ${d.name} - ${d.vehicle} <button onclick="deleteDriver('${d.phone}')">ğŸ—‘</button></div>`;});
}

function deleteDriver(phone){db.ref("drivers/"+phone).remove();}
function deleteOrder(id){db.ref("orders/"+id).remove();}

// ===== Render Driver Options =====
function renderDriversSelect(){
  selectDriver.innerHTML='<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø³ÙˆØ§Ù‚</option>';
  drivers.forEach(d=>{const opt=document.createElement("option");opt.value=d.phone;opt.textContent=d.name+" - "+d.vehicle;selectDriver.appendChild(opt);});
}
</script>

</body>
</html>
